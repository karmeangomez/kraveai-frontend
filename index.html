<!DOCTYPE html>
<html lang="es">
<head>
  <!-- TU HEAD ORIGINAL INTACTO -->
</head>
<body>
  <!-- TU DISE√ëO ORIGINAL MANTENIDO -->

  <!-- üîÑ SECCI√ìN MODIFICADA: Panel Crear Cuentas -->
  <div id="create-accounts-panel">
    <div class="back-button" id="volver-instagram">
      <i class="fas fa-arrow-left"></i> Volver
    </div>

    <div class="app-content">
      <div class="create-form">
        <div class="form-title">
          <i class="fas fa-user-plus"></i> Crear cuentas de Instagram
        </div>

        <div class="form-group">
          <label class="form-label">N√∫mero de cuentas a crear</label>
          <input type="number" id="account-count" class="form-input" value="3" min="1" max="100">
        </div>

        <div class="form-actions">
          <button class="form-btn cancel-btn" id="cancel-btn">Cancelar</button>
          <button class="form-btn submit-btn" id="create-btn">Crear cuentas</button>
        </div>
      </div>

      <div class="progress-section" id="progress-section">
        <div class="progress-container">
          <div class="progress-header">
            <div class="progress-title">Progreso de creaci√≥n</div>
            <div class="progress-stats">
              <span id="created-count">0</span> de <span id="total-count">0</span>
            </div>
          </div>

          <div class="progress-bar">
            <div class="progress-fill" id="progress-bar"></div>
          </div>

          <div class="accounts-list" id="accounts-container"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const createBtn = document.getElementById('create-btn');
    const cancelBtn = document.getElementById('cancel-btn');
    const progressBar = document.getElementById('progress-bar');
    const createdCount = document.getElementById('created-count');
    const totalCount = document.getElementById('total-count');
    const accountsContainer = document.getElementById('accounts-container');
    const progressSection = document.getElementById('progress-section');

    let accountsCreated = 0;
    let totalAccounts = 0;

    createBtn.addEventListener('click', function () {
      const count = parseInt(document.getElementById('account-count').value) || 1;

      progressSection.style.display = 'block';
      accountsContainer.innerHTML = '';
      createdCount.textContent = '0';
      totalCount.textContent = count;
      accountsCreated = 0;
      totalAccounts = count;

      const source = new EventSource(`/create-accounts-sse?count=${count}`);

      source.addEventListener('status', (e) => {
        const data = JSON.parse(e.data);
        console.log(`Estado: ${data.message}`);
      });

      source.addEventListener('account-created', (e) => {
        const data = JSON.parse(e.data);
        const item = document.createElement('div');
        item.className = 'account-item';
        item.textContent = `‚úÖ ${data.account.usuario || data.account.username}`;
        accountsContainer.appendChild(item);

        accountsCreated++;
        const progreso = (accountsCreated / totalAccounts) * 100;
        progressBar.style.width = `${progreso}%`;
        createdCount.textContent = accountsCreated;
      });

      source.addEventListener('complete', () => {
        console.log('‚úÖ Proceso completado');
        source.close();
      });

      source.addEventListener('error', (e) => {
        console.error('‚ùå Error SSE:', e);
        source.close();
      });
    });
  </script>
</body>
</html>
