<!DOCTYPE html><html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="theme-color" content="#0B0B0F" />
  <title>KraveAI ‚Äì Panel</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
  <style>
    :root{
      --bg: #0b0b0f;
      --surface: #111219;
      --surface-2:#141622;
      --card:#171a29;
      --text:#e9e9f1;
      --muted:#9aa0b4;
      --brand:#7c5cff;      /* primario */
      --brand-2:#00dbc0;    /* acento */
      --danger:#ff4d4f; 
      --warning:#ffb020;
      --success:#2ecc71;
      --ring: rgba(124,92,255,.45);
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius-xl: 22px;
      --radius-lg: 16px;
      --radius: 12px;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{
      font-family:ui-sans-serif, system-ui, -apple-system, "SF Pro Display", "Segoe UI", Roboto, Arial;
      background: radial-gradient(1200px 600px at 90% -10%, rgba(124,92,255,.18), transparent 60%),
                  radial-gradient(900px 500px at -10% 110%, rgba(0,219,192,.15), transparent 60%),
                  var(--bg);
      color:var(--text);
      -webkit-font-smoothing:antialiased; 
      overflow-x:hidden;
    }/* ---------- App Shell (tipo app m√≥vil) ---------- */
.app{ display:grid; grid-template-rows:auto 1fr auto; min-height:100dvh; }
.app-header{ position:sticky; top:0; z-index:50; display:flex; align-items:center; justify-content:space-between; padding:14px 18px; background: rgba(17,18,25,.75); backdrop-filter: blur(10px); border-bottom:1px solid rgba(255,255,255,.06); }
.brand{display:flex;align-items:center;gap:12px;font-weight:800;font-size:1.15rem}
.brand-badge{display:grid;place-items:center;width:36px;height:36px;border-radius:12px;background:linear-gradient(135deg,var(--brand),var(--brand-2));box-shadow:0 4px 18px rgba(124,92,255,.35)}
.brand span{background:linear-gradient(90deg,#fff, #c8c8ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.header-right{display:flex;align-items:center;gap:10px}
.pill{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:999px;background:rgba(124,92,255,.12);border:1px solid rgba(124,92,255,.25);font-size:.85rem;color:#d8d5ff}
.avatar{width:34px;height:34px;border-radius:50%;display:grid;place-items:center;background:linear-gradient(135deg,var(--brand),var(--brand-2));font-weight:700}
.icon-btn{width:36px;height:36px;border-radius:10px;display:grid;place-items:center;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.08);cursor:pointer;transition:transform .15s ease}
.icon-btn:hover{transform:translateY(-1px)}

.app-content{padding:18px;max-width:1100px;margin:0 auto;width:100%}

/* ---------- Historias tipo red social ---------- */
.stories{display:flex;gap:12px;overflow:auto;padding-bottom:8px;margin-bottom:14px}
.story{min-width:72px;display:flex;flex-direction:column;align-items:center;gap:6px}
.ring{width:62px;height:62px;border-radius:50%;display:grid;place-items:center;background:conic-gradient(from 0deg, var(--brand), var(--brand-2)); padding:2px}
.ring img{width:100%;height:100%;border-radius:50%;object-fit:cover;border:3px solid var(--surface)}
.story small{color:#cfd2e3;max-width:72px;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}

/* ---------- Feed tipo tarjetas ---------- */
.feed{display:grid;gap:14px}
.post{background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.06);border-radius:var(--radius-xl);box-shadow:var(--shadow)}
.post-header{display:flex;gap:10px;align-items:center;padding:12px 14px}
.post-header img{width:40px;height:40px;border-radius:12px;object-fit:cover;border:2px solid rgba(255,255,255,.08)}
.post-actions{display:flex;gap:10px;padding:10px 14px;border-top:1px solid rgba(255,255,255,.06)}
.ghost{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.1);padding:8px 12px;border-radius:12px;cursor:pointer}

/* ---------- Tarjetas principales Home ---------- */
.grid{display:grid;gap:14px}
@media(min-width:680px){.grid{grid-template-columns:repeat(3,minmax(0,1fr))}}
.app-card{background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.06);border-radius:var(--radius-xl);padding:16px; box-shadow: var(--shadow);transition: transform .18s ease, border-color .18s ease;}
.app-card:hover{transform:translateY(-2px);border-color:rgba(124,92,255,.35)}
.app-card .row{display:flex;align-items:center;gap:12px;margin-bottom:8px}
.chip{font-size:.8rem;color:var(--muted);}
.social-tile{display:flex;flex-direction:column;gap:14px;cursor:pointer}
.social-icon{width:54px;height:54px;border-radius:14px;display:grid;place-items:center;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.08)}
.social-title{font-weight:600}

/* ---------- Secciones / t√≠tulos ---------- */
.section-title{display:flex;align-items:center;gap:10px;font-size:1rem;margin:10px 0 6px}
.muted{color:var(--muted)}

/* ---------- Acciones / inputs ---------- */
.action-box{display:flex;gap:10px;align-items:center;background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:10px 10px 10px 14px}
.action-box input{flex:1;background:transparent;border:0;color:var(--text);font-size:1rem;outline:none}
.btn{display:inline-flex;align-items:center;gap:8px;cursor:pointer;border:0;border-radius:14px;padding:10px 14px;font-weight:600}
.btn-primary{background:linear-gradient(135deg,var(--brand),#5d3cff);color:white;box-shadow:0 8px 20px rgba(124,92,255,.35)}
.btn-ghost{background:rgba(255,255,255,.06);color:var(--text);border:1px solid rgba(255,255,255,.1)}

/* ---------- Estado del sistema ---------- */
.status{display:flex;align-items:center;gap:10px;margin-top:10px}
.dot{width:10px;height:10px;border-radius:50%}

/* Paneles deslizables tipo app */
.panel{position:fixed;inset:0;background:var(--surface-2);transform:translateX(100%);transition:transform .35s ease;z-index:100;overflow-y:auto}
.panel.active{transform:translateX(0)}
.panel .panel-inner{max-width:1100px;margin:0 auto;padding:18px}
.back{display:inline-flex;align-items:center;gap:8px;color:#cfcfff;text-decoration:none;margin:6px 0 14px}

/* Tarjeta de formulario */
.form-card{background:var(--card);border:1px solid rgba(255,255,255,.07);border-radius:var(--radius-xl);padding:18px;box-shadow:var(--shadow)}
.form-row{display:grid;gap:10px;margin:10px 0}
.label{font-weight:600;margin-bottom:4px}
.input, .select, textarea{width:100%;background:#0f111a;border:1px solid rgba(255,255,255,.08);border-radius:12px;color:var(--text);padding:14px;font-size:1rem;outline:none}
.input:focus, .select:focus, textarea:focus{border-color:var(--ring);box-shadow:0 0 0 4px rgba(124,92,255,.15)}

/* Lista de cuentas */
.list{list-style:none;display:grid;gap:8px}
.list li{display:flex;align-items:center;justify-content:space-between;gap:10px;background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:10px}
.list .left{display:flex;align-items:center;gap:10px}
.mini-dot{width:8px;height:8px;border-radius:50%}
.mini-btn{padding:6px 10px;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.06);border-radius:10px;cursor:pointer}
.mini-btn:hover{border-color:rgba(124,92,255,.4)}

/* Resultados de usuario */
.user-result{display:none;background:var(--card);border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:14px;margin-top:12px;animation:fadeIn .35s ease forwards}
.user-header{display:flex;align-items:center;gap:12px;margin-bottom:10px}
.user-avatar{width:70px;height:70px;border-radius:14px;border:2px solid var(--brand);object-fit:cover}
.stats{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-top:8px}
.stat{background:#0f111a;border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:10px;text-align:center}
.badge{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12)}

/* Notificaci√≥n (snackbar) */
.snack{position:fixed;left:50%;top:18px;transform:translateX(-50%);opacity:0;background:#121325;border:1px solid rgba(124,92,255,.35);color:#fff;padding:12px 18px;border-radius:999px;z-index:1000;transition:opacity .25s ease}
.snack.show{opacity:1}
.snack.error{background:#2a0e12;border-color:#ff6b6b}

/* Barra inferior tipo app */
.tabbar{position:sticky;bottom:0;z-index:40;background:rgba(17,18,25,.8);backdrop-filter:blur(10px);border-top:1px solid rgba(255,255,255,.06)}
.tabs{display:grid;grid-template-columns:repeat(4,1fr)}
.tab{display:flex;flex-direction:column;align-items:center;gap:4px;padding:10px 8px;color:var(--muted);text-decoration:none}
.tab.active,.tab:hover{color:#dcdcff}

/* Utilidades extra requeridas por JS existente */
.status-indicator{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:999px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.08)}
.status-indicator-panel{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.08)}
.status-dot{width:10px;height:10px;border-radius:50%}
.status-dot-panel{width:10px;height:10px;border-radius:50%}
.status-active .status-dot-panel{background:var(--success)}
.status-error .status-dot-panel{background:var(--danger)}
.hidden{display:none !important}

@keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:none}}

  </style>
</head>
<body>
  <div class="app">
    <!-- Header -->
    <header class="app-header">
      <div class="brand">
        <div class="brand-badge"><i class="fa-solid fa-bolt"></i></div>
        <span>KraveAI</span>
      </div>
      <div class="header-right">
        <div class="pill" id="system-pill"><span class="dot" id="system-status-dot" style="background:var(--warning)"></span><span id="system-status-text">Conectando‚Ä¶</span></div>
        <div class="icon-btn" id="refresh-btn" title="Actualizar"><i class="fa-solid fa-rotate"></i></div>
        <div class="avatar">KG</div>
      </div>
    </header><!-- Content -->
<main class="app-content">
  <!-- Historias (avatars = cuentas activas recientes) -->
  <section class="stories" id="stories-row" aria-label="Historias"></section>

  <!-- Feed de estado (cards sociales) -->
  <section class="feed" id="status-feed">
    <!-- Post de sistema (se llena por JS) -->
  </section>

  <!-- Redes -->
  <section style="margin-top:6px" aria-label="Redes sociales">
    <div class="grid">
      <div class="app-card social-tile" id="instagram-link" role="button">
        <div class="row">
          <div class="social-icon" style="background:rgba(225,48,108,.12)"><i class="fa-brands fa-instagram" style="color:#E1306C"></i></div>
          <div>
            <div class="social-title">Instagram</div>
            <div class="chip">Automatiza acciones y maneja sesiones</div>
          </div>
        </div>
      </div>

      <div class="app-card social-tile" id="tiktok-link" role="button">
        <div class="row">
          <div class="social-icon" style="background:rgba(105,201,208,.12)"><i class="fa-brands fa-tiktok" style="color:#69C9D0"></i></div>
          <div>
            <div class="social-title">TikTok</div>
            <div class="chip">(Pr√≥ximamente)</div>
          </div>
        </div>
      </div>

      <div class="app-card social-tile" id="youtube-link" role="button">
        <div class="row">
          <div class="social-icon" style="background:rgba(255,0,0,.12)"><i class="fa-brands fa-youtube" style="color:#ff0000"></i></div>
          <div>
            <div class="social-title">YouTube</div>
            <div class="chip">(Pr√≥ximamente)</div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Acci√≥n r√°pida -->
  <section style="margin-top:16px">
    <div class="section-title"><i class="fa-solid fa-wand-magic-sparkles"></i><span>Automatizaci√≥n</span></div>
    <div class="action-box">
      <input id="automation-input" placeholder="¬øQu√© quieres automatizar hoy?" />
      <button class="btn btn-primary" id="send-btn"><i class="fa-solid fa-paper-plane"></i> Ejecutar</button>
    </div>
    <div class="status" style="margin-top:12px">
      <div class="status-indicator">
        <div class="status-dot" id="status-dot" style="background:var(--success)"></div>
        <span id="active-accounts" class="muted">Listo</span>
      </div>
    </div>
  </section>

  <!-- Clientes recientes -->
  <section style="margin-top:16px">
    <div class="section-title"><i class="fa-solid fa-users"></i><span>Clientes recientes</span></div>
    <div class="grid" style="grid-template-columns:repeat(auto-fit,minmax(220px,1fr))">
      <div class="app-card">
        <div class="row"><div class="social-icon" style="background:rgba(225,48,108,.12)"><i class="fa-brands fa-instagram" style="color:#E1306C"></i></div><strong>@arianaoficial</strong></div>
        <div class="muted">Instagram</div>
      </div>
      <div class="app-card">
        <div class="row"><div class="social-icon" style="background:rgba(255,0,0,.12)"><i class="fa-brands fa-youtube" style="color:#FF0000"></i></div><strong>@plenkay</strong></div>
        <div class="muted">YouTube</div>
      </div>
    </div>
  </section>
</main>

<!-- Tabbar -->
<nav class="tabbar">
  <div class="tabs">
    <a class="tab active" href="#"><i class="fa-solid fa-house"></i><small>Inicio</small></a>
    <a class="tab" href="#"><i class="fa-solid fa-chart-line"></i><small>Anal√≠tica</small></a>
    <a class="tab" href="#"><i class="fa-solid fa-gear"></i><small>Ajustes</small></a>
    <a class="tab" href="#"><i class="fa-solid fa-user"></i><small>Perfil</small></a>
  </div>
</nav>

  </div>  <!-- ============== PANELS ============== -->  <!-- Instagram Panel -->  <div id="instagram-panel" class="panel">
    <div class="panel-inner">
      <a href="#" class="back" id="volver-inicio"><i class="fa-solid fa-arrow-left"></i> Volver</a><h2 class="section-title"><i class="fa-brands fa-instagram" style="color:#E1306C"></i><span>Panel de Instagram</span></h2>
  <p class="muted" style="margin-bottom:12px">Elige qu√© deseas automatizar</p>

  <div class="grid" style="grid-template-columns:repeat(auto-fit,minmax(160px,1fr))">
    <div class="app-card social-tile"><div class="row">üë•<strong>Clientes</strong></div></div>
    <div class="app-card social-tile"><div class="row">üîß<strong>Servicios</strong></div></div>
    <div class="app-card social-tile"><div class="row">‚ù§Ô∏è<strong>Likes</strong></div></div>
    <div class="app-card social-tile"><div class="row">‚ûï<strong>Seguidores</strong></div></div>
    <div class="app-card social-tile"><div class="row">üëÅÔ∏è<strong>Vistas</strong></div></div>
    <div class="app-card social-tile" id="comments-link"><div class="row">üí¨<strong>Comentarios</strong></div></div>
    <div class="app-card social-tile"><div class="row">üîÅ<strong>Compartidos</strong></div></div>
    <div class="app-card social-tile" id="crear-cuentas-link"><div class="row">‚ûï<strong>Crear cuentas</strong></div></div>
    <div class="app-card social-tile" id="login-link"><div class="row">üîê<strong>Login</strong></div></div>
    <div class="app-card social-tile" id="ver-cuentas-link"><div class="row">üìã<strong>Ver cuentas generadas</strong></div></div>
  </div>
</div>

  </div>  <!-- Create Accounts Panel -->  <div id="create-accounts-panel" class="panel">
    <div class="panel-inner">
      <a href="#" class="back" id="volver-instagram"><i class="fa-solid fa-arrow-left"></i> Volver</a><div class="form-card">
    <h3 class="section-title"><i class="fa-solid fa-user-plus"></i><span>Crear nuevas cuentas</span></h3>
    <p class="muted">Sistema automatizado para creaci√≥n de cuentas de Instagram</p>
    <div class="form-row">
      <div class="label">N√∫mero de cuentas a crear</div>
      <input type="number" id="account-count" class="input" value="5" min="1" max="100" />
    </div>
    <div class="form-row" style="display:flex;gap:10px">
      <button class="btn btn-ghost" id="cancel-btn"><i class="fa-solid fa-xmark"></i> Cancelar</button>
      <button class="btn btn-primary" id="create-btn"><i class="fa-solid fa-play"></i> Iniciar creaci√≥n</button>
    </div>
  </div>
</div>

  </div>  <!-- Login Panel -->  <div id="login-panel" class="panel">
    <div class="panel-inner">
      <a href="#" class="back" id="volver-login"><i class="fa-solid fa-arrow-left"></i> Volver</a><div class="form-card" id="login-form">
    <h3 class="section-title"><i class="fa-solid fa-key"></i><span>Gesti√≥n de Sesiones</span></h3>
    <p class="muted">Controla tus inicios de sesi√≥n en Instagram</p>

    <div class="form-row">
      <div class="label">Usuario de Instagram</div>
      <input type="text" id="login-username" class="input" placeholder="Usuario de Instagram" />
    </div>
    <div class="form-row">
      <div class="label">Contrase√±a</div>
      <div style="position:relative">
        <input type="password" id="login-password" class="input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
        <span id="togglePassword" style="position:absolute;right:12px;top:50%;transform:translateY(-50%);cursor:pointer;opacity:.7">üëÅÔ∏è</span>
      </div>
    </div>

    <div class="form-row">
      <div class="label">Estado de sesi√≥n</div>
      <div class="status-indicator-panel" id="session-status">
        <div class="status-dot-panel"></div>
        <span id="session-status-text">No hay sesi√≥n activa</span>
      </div>
    </div>
    <div class="form-row" style="display:flex;gap:10px">
      <button class="btn btn-primary" id="login-btn"><i class="fa-solid fa-right-to-bracket"></i> Iniciar sesi√≥n</button>
      <button class="btn btn-ghost" id="logout-btn"><i class="fa-solid fa-right-from-bracket"></i> Cerrar sesi√≥n</button>
    </div>
  </div>

  <div class="form-card" style="margin-top:12px">
    <h3 class="section-title"><i class="fa-solid fa-user-plus"></i><span>Agregar Cuenta Manual</span></h3>
    <div class="form-row">
      <div class="label">Usuario</div>
      <input type="text" id="manual-username" class="input" placeholder="Ingresa el usuario" required />
    </div>
    <div class="form-row">
      <div class="label">Contrase√±a</div>
      <div style="position:relative">
        <input type="password" id="manual-password" class="input" placeholder="Ingresa la contrase√±a" required />
        <span id="toggleManualPassword" style="position:absolute;right:12px;top:50%;transform:translateY(-50%);cursor:pointer;opacity:.7">üëÅÔ∏è</span>
      </div>
    </div>
    <div class="form-row">
      <button class="btn btn-primary" id="add-account-btn"><i class="fa-solid fa-floppy-disk"></i> Guardar Cuenta</button>
    </div>
  </div>

  <div class="form-card" style="margin-top:12px">
    <div class="label">Cuentas activas</div>
    <ul id="cuentas-activas-list" class="list">
      <li>Cargando cuentas‚Ä¶</li>
    </ul>
  </div>

  <div class="form-card" style="margin-top:12px">
    <div class="label">Buscar usuario de Instagram</div>
    <div class="form-row" style="display:flex;gap:10px">
      <input type="text" id="username-search" class="input" placeholder="@usuario" />
      <button class="btn btn-primary" id="search-user-btn"><i class="fa-solid fa-magnifying-glass"></i> Buscar</button>
    </div>
    <div id="user-result" class="user-result">
      <div class="user-header">
        <img id="user-avatar" class="user-avatar" src="" alt="Avatar" />
        <div>
          <h3 id="user-username" style="display:flex;align-items:center;gap:6px"></h3>
          <div id="user-fullname" class="muted"></div>
        </div>
      </div>
      <div class="stats">
        <div class="stat"><div class="muted">Publicaciones</div><div class="value" id="user-posts" style="font-weight:700;font-size:1.1rem">0</div></div>
        <div class="stat"><div class="muted">Seguidores</div><div class="value" id="user-followers" style="font-weight:700;font-size:1.1rem">0</div></div>
        <div class="stat"><div class="muted">Siguiendo</div><div class="value" id="user-following" style="font-weight:700;font-size:1.1rem">0</div></div>
      </div>
      <div class="form-row"><div class="label">Bio</div><div id="user-bio-text" class="muted"></div></div>
      <div class="form-row" style="display:flex;flex-wrap:wrap;gap:8px">
        <span id="user-private" class="badge"><span class="status-dot-panel"></span><span>Privado: Desconocido</span></span>
        <span id="user-verified" class="badge"><span class="status-dot-panel"></span><span>Verificado: No</span></span>
        <span id="user-business" class="badge"><span class="status-dot-panel"></span><span>Negocio: No</span></span>
      </div>
    </div>
  </div>
</div>

  </div>  <!-- Comments Panel -->  <div id="comments-panel" class="panel">
    <div class="panel-inner">
      <a href="#" class="back" id="volver-inicio-comments"><i class="fa-solid fa-arrow-left"></i> Volver</a><div class="form-card">
    <h3 class="section-title"><i class="fa-solid fa-comments"></i><span>Automatizaci√≥n de Comentarios</span></h3>
    <p class="muted">Configura y lanza comentarios masivos en Instagram</p>
    <form id="formComentarios">
      <div class="form-row">
        <div class="label">URL del Post</div>
        <input name="url" class="input" placeholder="https://www.instagram.com/p/CXXXXX/" required />
      </div>
      <div class="form-row">
        <div class="label">Cantidad de Comentarios</div>
        <input type="number" name="cantidad" class="input" value="30" min="1" max="100" required />
      </div>
      <div class="form-row">
        <div class="label">Modo</div>
        <select name="modo" id="modo-select" class="select">
          <option value="auto">Auto (basado en imagen)</option>
          <option value="personalizado">Personalizado (con estilo)</option>
          <option value="manual">Manual (pegar comentarios)</option>
        </select>
      </div>
      <div class="form-row" id="manualSection" style="display:none">
        <div class="label">Comentarios Manuales</div>
        <textarea name="comentarios" rows="4" placeholder="Pega un comentario por l√≠nea"></textarea>
      </div>
      <div class="form-row"><div class="label">Apodo (Opcional)</div><input name="apodo" class="input" placeholder="Ej: Gera" /></div>
      <div class="form-row"><div class="label">Estilo</div><input name="estilo" class="input" placeholder="Ej: fitness, sexy, guapo" /></div>
      <div class="form-row"><div class="label">Actividad</div><input name="actividad" class="input" placeholder="Ej: entrenador personal" /></div>
      <div class="form-row"><div class="label">Ejemplos de Comentarios</div><textarea name="ejemplos" rows="4" placeholder="Un comentario por l√≠nea"></textarea></div>
      <div class="form-row" style="display:flex;gap:10px">
        <button type="submit" class="btn btn-primary">Lanzar Comentarios</button>
        <button type="button" class="btn btn-ghost" id="cancelComment">Cancelar</button>
      </div>
    </form>
    <div id="commentStatus" class="status-indicator" style="display:none;margin-top:12px">
      <div class="status-dot"></div>
      <span id="commentMessage"></span>
    </div>
  </div>
</div>

  </div>  <!-- Ver Cuentas generadas Panel (nuevo, UI) -->  <div id="ver-cuentas-panel" class="panel">
    <div class="panel-inner">
      <a href="#" class="back" id="volver-instagram-desde-ver"><i class="fa-solid fa-arrow-left"></i> Volver</a>
      <div class="form-card">
        <h3 class="section-title"><i class="fa-regular fa-clipboard"></i><span>Cuentas generadas</span></h3>
        <ul class="list" id="lista-cuentas-generadas">
          <li>No hay registros a√∫n</li>
        </ul>
      </div>
    </div>
  </div>  <!-- Snackbar -->  <div class="snack" id="notification"><i class="fa-solid fa-circle-check"></i> <span id="notification-text"></span></div>  <!-- ================== JS (IDs y endpoints intactos) ================== -->  <script>
    // ---- Referencias DOM ----
    const instagramLink = document.getElementById('instagram-link');
    const volverInicio = document.getElementById('volver-inicio');
    const crearCuentasLink = document.getElementById('crear-cuentas-link');
    const volverInstagram = document.getElementById('volver-instagram');
    const loginLink = document.getElementById('login-link');
    const volverLogin = document.getElementById('volver-login');
    const commentsLink = document.getElementById('comments-link');
    const volverInicioComments = document.getElementById('volver-inicio-comments');
    const verCuentasLink = document.getElementById('ver-cuentas-link');
    const volverInstagramDesdeVer = document.getElementById('volver-instagram-desde-ver');

    const instagramPanel = document.getElementById('instagram-panel');
    const createAccountsPanel = document.getElementById('create-accounts-panel');
    const loginPanel = document.getElementById('login-panel');
    const commentsPanel = document.getElementById('comments-panel');
    const verCuentasPanel = document.getElementById('ver-cuentas-panel');

    const notification = document.getElementById('notification');
    const notificationText = document.getElementById('notification-text');
    const automationInput = document.getElementById('automation-input');
    const sendBtn = document.getElementById('send-btn');
    const refreshBtn = document.getElementById('refresh-btn');

    const loginForm = document.getElementById('login-form');
    const loginBtn = document.getElementById('login-btn');
    const logoutBtn = document.getElementById('logout-btn');
    const loginUsername = document.getElementById('login-username');
    const loginPassword = document.getElementById('login-password');
    const sessionStatus = document.getElementById('session-status');
    const sessionStatusText = document.getElementById('session-status-text');
    const addAccountBtn = document.getElementById('add-account-btn');
    const manualUsername = document.getElementById('manual-username');
    const manualPassword = document.getElementById('manual-password');
    const searchUserBtn = document.getElementById('search-user-btn');
    const usernameSearch = document.getElementById('username-search');
    const userResult = document.getElementById('user-result');
    const systemStatusDot = document.getElementById('system-status-dot');
    const systemStatusText = document.getElementById('system-status-text');
    const cuentasActivasList = document.getElementById('cuentas-activas-list');

    const cancelBtn = document.getElementById('cancel-btn');
    const createBtn = document.getElementById('create-btn');
    const accountCountInput = document.getElementById('account-count');

    const storiesRow = document.getElementById('stories-row');
    const statusFeed = document.getElementById('status-feed');

    const API_URL = "https://api.kraveapi.xyz";
    let isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
    let cuentasActivasInterval; let cuentasActivas = [];

    // ---------- UI helpers ----------
    function showNotification(message, isError=false){
      notificationText.textContent = message;
      notification.classList.add('show');
      if(isError){ notification.classList.add('error'); } else { notification.classList.remove('error'); }
      setTimeout(()=>notification.classList.remove('show'), 2600);
    }

    function addFeedCard({title, text, icon='fa-bolt'}){
      const card = document.createElement('article');
      card.className = 'post';
      card.innerHTML = `
        <div class="post-header">
          <img src="https://i.pravatar.cc/80?u=${encodeURIComponent(title)}" alt="avatar" />
          <div>
            <strong>${title}</strong>
            <div class="muted" style="font-size:.85rem">${new Date().toLocaleString()}</div>
          </div>
        </div>
        <div style="padding:0 14px 14px">${text}</div>
        <div class="post-actions">
          <button class="ghost"><i class="fa-regular fa-heart"></i> Like</button>
          <button class="ghost"><i class="fa-regular fa-comment"></i> Comentar</button>
          <button class="ghost"><i class="fa-regular fa-bookmark"></i> Guardar</button>
        </div>`;
      statusFeed.prepend(card);
    }

    // ---------- Historias a partir de cuentas activas ----------
    function renderStories(list){
      storiesRow.innerHTML = '';
      list.slice(0,12).forEach(acc=>{
        const s = document.createElement('div');
        s.className='story';
        s.innerHTML = `
          <div class="ring"><img src="https://api.dicebear.com/7.x/initials/svg?seed=${acc.username}" alt="${acc.username}" /></div>
          <small>@${acc.username}</small>`;
        storiesRow.appendChild(s);
      });
    }

    // ---------- Navegaci√≥n de paneles ----------
    instagramLink?.addEventListener('click', (e)=>{ e.preventDefault(); instagramPanel.classList.add('active'); });
    volverInicio?.addEventListener('click', (e)=>{ e.preventDefault(); instagramPanel.classList.remove('active'); });
    crearCuentasLink?.addEventListener('click', (e)=>{ e.preventDefault(); createAccountsPanel.classList.add('active'); instagramPanel.classList.remove('active'); });
    volverInstagram?.addEventListener('click', (e)=>{ e.preventDefault(); createAccountsPanel.classList.remove('active'); instagramPanel.classList.add('active'); });
    loginLink?.addEventListener('click', async (e)=>{ e.preventDefault(); loginPanel.classList.add('active'); instagramPanel.classList.remove('active'); await checkSessionStatus(); actualizarListaCuentasActivas(); if(cuentasActivasInterval) clearInterval(cuentasActivasInterval); cuentasActivasInterval = setInterval(actualizarListaCuentasActivas, 30000); });
    volverLogin?.addEventListener('click', (e)=>{ e.preventDefault(); loginPanel.classList.remove('active'); if(cuentasActivasInterval) clearInterval(cuentasActivasInterval); instagramPanel.classList.add('active'); });
    commentsLink?.addEventListener('click', (e)=>{ e.preventDefault(); commentsPanel.classList.add('active'); instagramPanel.classList.remove('active'); });
    volverInicioComments?.addEventListener('click', (e)=>{ e.preventDefault(); commentsPanel.classList.remove('active'); instagramPanel.classList.add('active'); });
    verCuentasLink?.addEventListener('click', (e)=>{ e.preventDefault(); verCuentasPanel.classList.add('active'); instagramPanel.classList.remove('active'); cargarCuentasGeneradas(); });
    volverInstagramDesdeVer?.addEventListener('click', (e)=>{ e.preventDefault(); verCuentasPanel.classList.remove('active'); instagramPanel.classList.add('active'); });

    // ---------- Acciones r√°pidas ----------
    sendBtn?.addEventListener('click', ()=>{ if(automationInput.value.trim()!==''){ addFeedCard({title:'Automatizaci√≥n', text:`Ejecutando: "${automationInput.value}"`}); showNotification(`Automatizando: "${automationInput.value}"`); automationInput.value=''; } });
    refreshBtn?.addEventListener('click', ()=>{ refreshBtn.style.transform='rotate(180deg)'; setTimeout(()=>refreshBtn.style.transform='', 250); checkBackendConnection(); });

    // ---------- Backend / Estado ----------
    async function checkBackendConnection(){
      try{
        const r = await fetch(`${API_URL}/health`, { credentials:'include' });
        if(r.ok){ systemStatusDot.style.background = 'var(--success)'; systemStatusText.textContent='Conectado al backend'; return true; }
        throw new Error('Backend responded with error');
      }catch(err){ systemStatusDot.style.background='var(--danger)'; systemStatusText.textContent='Error de conexi√≥n'; return false; }
    }

    async function checkSessionStatus(){
      try{
        const r = await fetch(`${API_URL}/estado-sesion`, { credentials:'include' });
        const data = await r.json();
        if(data.status==='activo'){
          isLoggedIn = true; localStorage.setItem('isLoggedIn','true');
          sessionStatus.className = 'status-indicator-panel status-active';
          sessionStatus.querySelector('.status-dot-panel').style.background='var(--success)';
          sessionStatusText.textContent = `‚úÖ Sesi√≥n activa como @${data.usuario}`;
          loginForm.style.display='none'; logoutBtn.classList.remove('hidden');
          showNotification(`Sesi√≥n activa como @${data.usuario}`);
        }else{
          isLoggedIn=false; localStorage.setItem('isLoggedIn','false');
          sessionStatus.className = 'status-indicator-panel status-error';
          sessionStatus.querySelector('.status-dot-panel').style.background='var(--danger)';
          sessionStatusText.textContent = '‚ùå No hay sesi√≥n activa';
          loginForm.style.display='block'; logoutBtn.classList.add('hidden');
        }
      }catch(e){
        isLoggedIn=false; localStorage.setItem('isLoggedIn','false');
        sessionStatus.className = 'status-indicator-panel status-error';
        sessionStatus.querySelector('.status-dot-panel').style.background='var(--danger)';
        sessionStatusText.textContent = '‚ùå Error al verificar sesi√≥n';
        loginForm.style.display='block'; logoutBtn.classList.add('hidden');
        showNotification('Error al verificar sesi√≥n', true);
      }
    }

    async function login(){
      const username = loginUsername.value.trim().replace('@','');
      const password = loginPassword.value.trim();
      if(!username||!password){ return showNotification('Completa usuario y contrase√±a', true); }
      try{
        loginBtn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Iniciando‚Ä¶'; loginBtn.disabled=true;
        const r = await fetch(`${API_URL}/iniciar-sesion`, { method:'POST', headers:{'Content-Type':'application/json'}, credentials:'include', body:JSON.stringify({usuario:username, contrasena:password}) });
        const data = await r.json();
        if(data.exito){
          isLoggedIn=true; localStorage.setItem('isLoggedIn','true');
          sessionStatus.className='status-indicator-panel status-active';
          sessionStatus.querySelector('.status-dot-panel').style.background='var(--success)';
          sessionStatusText.textContent=`‚úÖ Sesi√≥n iniciada como @${data.usuario}`;
          loginForm.style.display='none'; logoutBtn.classList.remove('hidden');
          showNotification(`Sesi√≥n iniciada como @${data.usuario}`); actualizarListaCuentasActivas();
        }else{ throw new Error(data.mensaje||'Error al iniciar sesi√≥n'); }
      }catch(err){
        sessionStatus.className='status-indicator-panel status-error';
        sessionStatus.querySelector('.status-dot-panel').style.background='var(--danger)';
        sessionStatusText.textContent=`‚ùå ${err.message}`;
        loginForm.style.display='block'; logoutBtn.classList.add('hidden');
        showNotification(`Error: ${err.message}`, true);
      }finally{
        loginBtn.innerHTML = '<i class="fa-solid fa-right-to-bracket"></i> Iniciar sesi√≥n'; loginBtn.disabled=false;
      }
    }

    async function logout(){
      try{
        logoutBtn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Cerrando‚Ä¶'; logoutBtn.disabled=true;
        const r = await fetch(`${API_URL}/cerrar-sesion`, { credentials:'include' });
        const data = await r.json();
        if(data.exito){
          isLoggedIn=false; localStorage.setItem('isLoggedIn','false');
          sessionStatus.className='status-indicator-panel status-error';
          sessionStatus.querySelector('.status-dot-panel').style.background='var(--danger)';
          sessionStatusText.textContent='‚ùå Sesi√≥n cerrada';
          loginForm.style.display='block'; logoutBtn.classList.add('hidden');
          showNotification('Sesi√≥n cerrada correctamente');
        }else{ throw new Error(data.mensaje||'Error al cerrar sesi√≥n'); }
      }catch(err){ showNotification(`Error: ${err.message}`, true); }
      finally{ logoutBtn.innerHTML='<i class="fa-solid fa-right-from-bracket"></i> Cerrar sesi√≥n'; logoutBtn.disabled=false; }
    }

    async function addAccount(){
      const username = manualUsername.value.trim();
      const password = manualPassword.value.trim();
      if(!username||!password){ return showNotification('Completa ambos campos', true); }
      try{
        addAccountBtn.innerHTML='<i class="fa-solid fa-spinner fa-spin"></i> Guardando‚Ä¶'; addAccountBtn.disabled=true;
        const loginRes = await fetch(`${API_URL}/iniciar-sesion`, { method:'POST', headers:{'Content-Type':'application/json'}, credentials:'include', body:JSON.stringify({usuario:username, contrasena:password}) });
        const loginData = await loginRes.json();
        if(!loginData.exito){ throw new Error(loginData.mensaje||'Error al iniciar sesi√≥n con la cuenta'); }
        const saveRes = await fetch(`${API_URL}/guardar-cuenta`, { method:'POST', headers:{'Content-Type':'application/json'}, credentials:'include', body:JSON.stringify({username, password}) });
        const saveData = await saveRes.json();
        if(saveData.status==='ok'){
          showNotification(`‚úÖ Cuenta @${username} guardada`); manualUsername.value=''; manualPassword.value=''; actualizarListaCuentasActivas();
        }else{ throw new Error(saveData.message||'Error al guardar la cuenta'); }
      }catch(err){ showNotification(`Error: ${err.message}`, true); }
      finally{ addAccountBtn.innerHTML='<i class="fa-solid fa-floppy-disk"></i> Guardar Cuenta'; addAccountBtn.disabled=false; }
    }

    async function searchUser(){
      const username = usernameSearch.value.trim().replace('@','');
      if(!username){ return showNotification('Ingresa un usuario', true); }
      try{
        searchUserBtn.innerHTML='<i class="fa-solid fa-spinner fa-spin"></i> Buscando‚Ä¶'; searchUserBtn.disabled=true;
        const r = await fetch(`${API_URL}/buscar-usuario?username=${username}`, { credentials:'include' });
        const userData = await r.json();
        document.getElementById('user-avatar').src = userData.profile_pic_url_hd || 'https://via.placeholder.com/150?text=Sin+imagen';
        const usernameEl = document.getElementById('user-username');
        usernameEl.innerHTML = `@${userData.username}` + (userData.is_verified ? ' <i class="fa-solid fa-circle-check" style="color:#0095f6"></i>' : '');
        document.getElementById('user-fullname').textContent = userData.full_name || 'Sin nombre';
        document.getElementById('user-posts').textContent = (userData.media_count||0).toLocaleString();
        document.getElementById('user-followers').textContent = (userData.follower_count||0).toLocaleString();
        document.getElementById('user-following').textContent = (userData.following_count||0).toLocaleString();
        document.getElementById('user-bio-text').textContent = userData.biography || 'Sin biograf√≠a disponible';
        document.getElementById('user-private').innerHTML = `<span class="status-dot-panel" style="background:${userData.is_private?'var(--warning)':'var(--success)'}"></span><span>Privado: ${userData.is_private?'S√≠':'No'}</span>`;
        document.getElementById('user-verified').innerHTML = `<span class="status-dot-panel" style="background:${userData.is_verified?'var(--success)':'var(--muted)'}"></span><span>Verificado: ${userData.is_verified?'S√≠':'No'}</span>`;
        document.getElementById('user-business').innerHTML = `<span class="status-dot-panel" style="background:${userData.is_business?'var(--brand)':'var(--muted)'}"></span><span>Negocio: ${userData.is_business?'S√≠':'No'}</span>`;
        userResult.style.display='block';
        showNotification(`Usuario @${userData.username} encontrado`);
      }catch(err){ console.error(err); showNotification(`Error: ${err.message||'No se pudo encontrar el usuario'}`, true); }
      finally{ searchUserBtn.innerHTML='<i class="fa-solid fa-magnifying-glass"></i> Buscar'; searchUserBtn.disabled=false; }
    }

    // Mostrar/ocultar textarea de comentarios manuales
    document.getElementById('modo-select')?.addEventListener('change', (e)=>{
      const show = e.target.value === 'manual';
      document.getElementById('manualSection').style.display = show ? 'block' : 'none';
    });

    async function iniciarCreacionCuentas(){
      const cantidad = parseInt(accountCountInput.value);
      if(!cantidad || cantidad<=0 || cantidad>100){ return showNotification('‚ö†Ô∏è Ingresa una cantidad v√°lida (1-100)', true); }
      // UI only: mostramos progreso (la l√≥gica real la maneja el backend)
      addFeedCard({title:'Creaci√≥n de cuentas', text:`Iniciando creaci√≥n de ${cantidad} cuenta(s)‚Ä¶`});
      showNotification('Creaci√≥n iniciada');
    }

    async function actualizarListaCuentasActivas(){
      const lista = cuentasActivasList; if(!lista) return;
      try{
        const r = await fetch(`${API_URL}/cuentas-activas`, { credentials:'include' });
        const cuentas = await r.json(); cuentasActivas = cuentas;
        renderStories(cuentas);
        if(!cuentas.length){ lista.innerHTML='<li>No hay cuentas activas a√∫n</li>'; return; }
        lista.innerHTML='';
        cuentas.forEach(acc=>{
          const li=document.createElement('li');
          const left=document.createElement('div'); left.className='left';
          const dot=document.createElement('div'); dot.className='mini-dot'; dot.style.background = acc.status==='activo' ? 'var(--success)' : 'var(--danger)';
          left.appendChild(dot); left.appendChild(document.createTextNode('@'+acc.username));
          const actions=document.createElement('div');
          const btn=document.createElement('button'); btn.className='mini-btn';
          if(acc.status==='activo'){ btn.innerHTML='<i class="fa-solid fa-right-from-bracket"></i> Logout'; btn.onclick=()=>cerrarSesionCuenta(acc.username); }
          else{ btn.innerHTML='<i class="fa-solid fa-right-to-bracket"></i> Login'; btn.onclick=()=>iniciarSesionCuenta(acc.username); }
          actions.appendChild(btn);
          li.appendChild(left); li.appendChild(actions); lista.appendChild(li);
        });
      }catch(err){ lista.innerHTML='<li>Error al cargar las cuentas</li>'; }
    }

    async function iniciarSesionCuenta(username){
      try{ showNotification(`Iniciando sesi√≥n con @${username}‚Ä¶`);
        const r = await fetch(`${API_URL}/iniciar-sesion-cuenta`, { method:'POST', headers:{'Content-Type':'application/json'}, credentials:'include', body:JSON.stringify({usuario:username}) });
        const data = await r.json(); if(data.exito){ showNotification(`‚úÖ Sesi√≥n iniciada con @${username}`); actualizarListaCuentasActivas(); } else { throw new Error(data.mensaje||'Error al iniciar sesi√≥n'); }
      }catch(err){ showNotification(`Error: ${err.message}`, true); }
    }

    async function cerrarSesionCuenta(username){
      try{ showNotification(`Cerrando sesi√≥n de @${username}‚Ä¶`);
        const r = await fetch(`${API_URL}/cerrar-sesion-cuenta`, { method:'POST', headers:{'Content-Type':'application/json'}, credentials:'include', body:JSON.stringify({usuario:username}) });
        const data = await r.json(); if(data.exito){ showNotification(`‚úÖ Sesi√≥n cerrada con @${username}`); actualizarListaCuentasActivas(); } else { throw new Error(data.mensaje||'Error al cerrar sesi√≥n'); }
      }catch(err){ showNotification(`Error: ${err.message}`, true); }
    }

    async function cargarCuentasGeneradas(){
      // Si en el futuro hay endpoint dedicado, c√°mbialo aqu√≠; por ahora usamos cuentas-activas como mock
      const ul = document.getElementById('lista-cuentas-generadas');
      try{
        const r = await fetch(`${API_URL}/cuentas-activas`, { credentials:'include' });
        const cuentas = await r.json();
        if(!cuentas.length){ ul.innerHTML = '<li>No hay registros a√∫n</li>'; return; }
        ul.innerHTML='';
        cuentas.forEach(c=>{ const li=document.createElement('li'); li.innerHTML=`<div class="left"><div class="mini-dot" style="background:var(--brand)"></div>@${c.username}</div><div class="muted">${c.status}</div>`; ul.appendChild(li); });
      }catch(e){ ul.innerHTML='<li>Error al cargar</li>'; }
    }

    // Listeners
    loginBtn?.addEventListener('click', login);
    logoutBtn?.addEventListener('click', logout);
    addAccountBtn?.addEventListener('click', addAccount);
    searchUserBtn?.addEventListener('click', searchUser);
    usernameSearch?.addEventListener('keypress', (e)=>{ if(e.key==='Enter'){ searchUser(); }});
    createBtn?.addEventListener('click', iniciarCreacionCuentas);

    // Init
    document.addEventListener('DOMContentLoaded', async ()=>{
      showNotification('KraveAI listo ‚Äì ¬°Bienvenido!');
      await checkBackendConnection();
      await checkSessionStatus();
      actualizarListaCuentasActivas();
      // Feed inicial
      addFeedCard({title:'Sistema', text:'Bienvenido a tu panel. Todo listo para automatizar.'});
      setInterval(checkBackendConnection, 120000);
    });
  </script>  <!-- Toggles de contrase√±a -->  <script>
    document.getElementById('togglePassword')?.addEventListener('click', ()=>{
      const el = document.getElementById('login-password'); el.type = el.type==='password' ? 'text' : 'password';
    });
    document.getElementById('toggleManualPassword')?.addEventListener('click', ()=>{
      const el = document.getElementById('manual-password'); el.type = el.type==='password' ? 'text' : 'password';
    });
  </script></body>
</html>