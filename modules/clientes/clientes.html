<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Clientes Instagram</title>
  <link rel="stylesheet" href="../../styles.css" />
</head>
<body>
  <div class="container">
    <h1>Clientes de Instagram</h1>
    <input type="text" id="username" placeholder="Usuario de Instagram" />
    <button onclick="buscarCliente()">Buscar</button>
    <div id="resultado"></div>
  </div>

  <!-- Conexión global a config.js -->
  <script src="../../config.js"></script>
  <script>
    async function buscarCliente() {
      const user = document.getElementById("username").value.trim();
      const result = document.getElementById("resultado");

      if (!user) {
        result.innerText = "Escribe un nombre de usuario.";
        return;
      }

      result.innerText = "Buscando...";

      try {
        const res = await fetch(`${API.instagram}/api/scrape?username=${user}`);
        const data = await res.json();

        if (data.profile) {
          const p = data.profile;
          result.innerHTML = `
            <img src="${p.profilePic}" width="100" /><br/>
            <strong>${p.fullName} (${p.username})</strong><br/>
            Verificado: ${p.isVerified ? '✅' : '❌'}<br/>
            Privada: ${p.isPrivate ? '🔒' : '🌐'}<br/>
            Seguidores: ${p.followers}<br/>
            Siguiendo: ${p.following}<br/>
            Publicaciones: ${p.posts}<br/>
            Bio: ${p.bio || '–'}<br/>
            Enlace: <a href="${p.bioUrl}" target="_blank">${p.bioUrlDisplay}</a>
          `;
        } else {
          result.innerText = "No se encontró el perfil.";
        }
      } catch (err) {
        result.innerText = "Error al obtener el perfil.";
        console.error(err);
      }
    }
  </script>
</body>
</html>
